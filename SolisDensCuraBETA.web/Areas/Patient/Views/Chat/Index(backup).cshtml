@model IEnumerable<SolisDensCuraBETA.viewmodels.ChatMessageViewModel>

@{
    ViewData["Title"] = "Index(2)";
}

@using System.Security.Claims

<h1>Chat</h1>

<!-- Display chat messages -->
<div id="chatMessages">
    @if (Model != null && Model.Any())
    {
        foreach (var message in Model)
        {
            <div>
                <strong>@message.SenderId:</strong> @message.Message
            </div>
        }
    }
    else
    {
        <p>No messages available</p>
    }
</div>

<!-- Form to send messages -->
<form id="sendMessageForm" asp-controller="Chat" asp-action="SendMessage" method="post">
    <!-- Hidden field for sender ID -->
    <input type="hidden" name="senderId" value="@ViewContext.HttpContext.User.FindFirst(ClaimTypes.NameIdentifier)?.Value" />

    <!-- Dropdown list of users (excluding currently logged-in user) -->
    <select name="receiverId">
        @foreach (var user in ViewBag.Users)
        {
            <option value="@user.Id">@user.UserName</option>
        }
    </select>

    <!-- Input field for message -->
    <input type="text" name="message" />
    <!-- Submit button -->
    <button type="submit">Send</button>
</form>


